package fi.blaudoom.pentestgui.dao;

import fi.blaudoom.pentestgui.model.User;
import org.springframework.data.jpa.repository.Modifying;
import org.springframework.data.jpa.repository.Query;
import org.springframework.data.repository.CrudRepository;
import org.springframework.security.core.userdetails.UserDetailsService;
import org.springframework.transaction.annotation.Transactional;

import java.util.List;

@Transactional
public interface UserRepository extends CrudRepository<User, Long>, UserDetailsService
{

    List<User> findByUsername(String username);

    User findById(long id);


    default User loadUserByUsername(String username){
        List<User> users = this.findByUsername(username);
        if(users.isEmpty()){
            return null;
        }else {
            return users.get(0);
        }
    }
    @Modifying
    @Query("update users set password = :password where id = :id")
    void changeUserPassword(Long id, String password);

    @Modifying
    @Query("update users set email = :email where id = :id")
    void changeEmail(Long id, String email);

}