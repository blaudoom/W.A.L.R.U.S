package fi.blaudoom.pentestgui.service.settings;

import fi.blaudoom.pentestgui.dao.SettingsRepository;
import fi.blaudoom.pentestgui.model.Settings;
import jakarta.transaction.Transactional;
import org.springframework.stereotype.Service;

import java.util.ArrayList;
import java.util.List;
@Service
public class SettingsServiceImpl implements SettingsService {

    private final SettingsRepository settingsRepository;

    public SettingsServiceImpl(SettingsRepository settingsRepository) {
        this.settingsRepository = settingsRepository;
    }

    @Override
    public List<SettingsDto> listSettings() {
        List<SettingsDto> result = new ArrayList<>();
        settingsRepository.findAll().forEach(settings -> {
            result.add(new SettingsDto(settings.getId(),settings.getName(),settings.getValue()));
        });
        return result;
    }

    @Override
    public SettingsDto getSetting(String name) {
        return new SettingsDto(settingsRepository.findByName(name).getId(),settingsRepository.findByName(name).getName(),settingsRepository.findByName(name).getValue());
    }

    @Override
    @Transactional
    public Boolean saveSetting(SettingsDto newValue) {
        Settings settings = settingsRepository.findByName(newValue.getName());
        settings.setValue(newValue.getValue());
        settingsRepository.save(settings);
        return true;

    }

}
